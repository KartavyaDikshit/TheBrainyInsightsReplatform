<img src="https://r2cdn.perplexity.ai/pplx-full-logo-primary-dark%402x.png" style="height:64px;margin-right:32px"/>

# Use existing cPanel/VPS, set up MariaDB/MySQL locally, and get the repo running to a production‑ready demo

Below is a clear plan tailored for Windows 11 x64 and the GitHub repo you shared. It covers: using the existing cPanel server, database options (MariaDB/MySQL) locally and on the host, adapting the schema analysis you attached, integrating SEO + multilingual + AI stubs, fixing webpack/build issues, and a step‑by‑step path to go live. Where tools differ per host, I’ve given both choices.

Note: Because the repo and cPanel environment are specific to this project, the safest path is to deploy a Node.js app on cPanel using “Application Manager/Setup Node.js App,” run the Next.js server behind Apache/Nginx, and use MariaDB provided by the host. This lets production run on the same machine as the legacy site without DNS moves. For local dev, use MariaDB or MySQL with identical schema so the app swaps over cleanly.

## Can the same hosting be used?

- Yes, if cPanel has:
    - “Setup Node.js App” (or Application Manager) to run a Node server, and
    - MariaDB/MySQL with phpMyAdmin plus an account to create a database/user.
- If “Setup Node.js App” is missing, request it from the provider or use a subdomain on the same VPS with a reverse proxy to a Node process started via SSH/PM2.


## Architecture alignment

- Keep the Next.js App Router app with server components for SEO and i18n.
- ORM: Prisma with provider=mysql against MariaDB (MariaDB speaks the MySQL protocol). If Prisma keeps blocking on the current Windows dev box, proceed with MySQL Workbench + Prisma CLI in WSL or Docker to avoid Windows newline/encoding issues. Production can still be MariaDB.
- Multilingual: next-intl or next-i18next with locale subpaths (/en, /de, /fr, /es, /it, /ja, /ko).
- SEO: canonical + hreflang alternates, JSON‑LD, sitemaps, robots.
- AI content pipeline: start with an admin “staging” queue and OpenAI key; content enters translations after human approval.


## Database and schema plan

Use the schema analysis you attached as the basis; finalize these tables:

- categories, category_translations
- reports, report_translations
- users (admin/editor/viewer)
- leads (contact form)
- redirect_map
- media_assets
- ai_generation_queue, ai_log

These mirror what we already planned and are compatible with Prisma provider=mysql.

## Local setup on Windows 11 (no Docker, MariaDB or MySQL)

Option A: MariaDB locally

1) Install MariaDB Community (MSI), create root password, install as Windows service listening on 3306.
2) Create database and user:
    - Open “MariaDB Client (mysql)” and run:
        - CREATE DATABASE tbi CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci;
        - CREATE USER 'tbi_user'@'localhost' IDENTIFIED BY 'strong_password';
        - GRANT ALL PRIVILEGES ON tbi.* TO 'tbi_user'@'localhost';
        - FLUSH PRIVILEGES;
3) .env.local in repo root:
    - DATABASE_URL=mysql://tbi_user:strong_password@localhost:3306/tbi
    - PRISMA_PROVIDER=mysql
    - NEXTAUTH_SECRET=generate_a_random_string
    - DEMO_NO_DB=false
    - DEFAULT_LOCALE=en
    - LOCALES=en,de,fr,es,it,ja,ko
    - OPENAI_API_KEY=sk-... (optional for demo)

Option B: MySQL Community locally

- Same steps as above; it behaves the same for Prisma provider=mysql.

Tip if Prisma continues erroring on Windows:

- Use WSL (Ubuntu) for the Prisma CLI:
    - Enable WSL, install Ubuntu from Store.
    - From WSL, clone the repo into /mnt/c/Users/User/TheBrainyInsightsReplatform, run pnpm i and prisma commands there. This avoids Windows line‑ending/encoding issues that caused your enum parse errors.
- Or use Docker Desktop + official MariaDB image for the DB, but run the app on Windows.


## Prisma schema hardening

Use clean enums and no trailing commas to avoid the “not an enum value definition” error:

- enum Locale { EN DE FR ES IT JA KO }
- enum Status { DRAFT STAGED PUBLISHED }

Keep LF line endings and UTF‑8 (no BOM). If Windows keeps re‑writing line endings, set the repo’s .gitattributes to enforce LF for .prisma.

Commands to initialize:

- pnpm install
- pnpm dlx prisma format
- pnpm dlx prisma validate
- pnpm dlx prisma migrate dev --name init
- pnpm dlx prisma db seed
- pnpm dev

If validate fails only on Windows:

- Run these prisma commands inside WSL shell; then run pnpm dev on Windows—Prisma client is already generated.


## Importing initial data into MariaDB on cPanel

- Create a new MariaDB DB and user in cPanel’s MySQL Databases.
- In phpMyAdmin, import a seed SQL file generated by Prisma migrate or any CSVs exported from your legacy.
- Store cPanel DB credentials in a .env.production (set through “Setup Node.js App” env fields).


## Deploying on the same cPanel host

Two ways:

1) cPanel “Setup Node.js App”

- Upload the repo (excluding node_modules) into, say, ~/nodeapps/tbi.
- Build on the server:
    - In cPanel → Setup Node.js App → Create Application:
        - Node version that matches local (20.x recommended).
        - App root: nodeapps/tbi
        - Startup file: server.js (create one that starts Next in standalone mode) or use next start in the startup command.
        - Environment variables: DATABASE_URL, PRISMA_PROVIDER=mysql, NEXTAUTH_SECRET, NODE_ENV=production, LOCALES, DEFAULT_LOCALE.
    - In “Detected configuration files,” run “NPM Install.”
    - Build:
        - Either add a postinstall “next build” or SSH in and run pnpm build.
    - Start the app.

2) SSH + PM2

- If you have SSH, you can run:
    - pnpm install
    - pnpm build
    - pm2 start "pnpm start" --name tbi
- Configure Apache/Nginx proxy to port the app binds to (cPanel tool usually does this for you).

Static assets and images go in /public. If the legacy site is active, use a subdomain (e.g., beta.thebrainyinsights.com) pointed to the Node app. When ready, switch root or do page‑by‑page reverse proxy.

## Fixing the current “webpack does not work” issue

Typical causes on Windows + cPanel:

- Node version mismatch: Ensure Node 20.x locally and on cPanel “Setup Node.js App.”
- Ignored build scripts: Approve builds or rebuild on host. On cPanel, use the “Run NPM Install” button; then run pnpm build manually via Terminal to see errors.
- Prisma postinstall hooks: If they run and fail, temporarily disable prisma postinstall by removing it from package.json scripts. Generate Prisma client manually before building.
- next.config: Ensure output is not “standalone” only when using serverless; for cPanel+Node, default next start is fine. If using standalone, create server.js that requires the standalone server.

Example server.js (only if you pick standalone):

- const { createServer } = require('http');
- const next = require('next');
- const app = next({ dev: false });
- const handle = app.getRequestHandler();
- app.prepare().then(() => createServer((req, res) => handle(req, res)).listen(process.env.PORT || 3000));


## Step‑by‑step: set up DB + run locally + deploy

1) Local DB

- Install MariaDB or MySQL.
- Create DB/user and set DATABASE_URL.
- Ensure schema.prisma has provider = "mysql" and enums as above.

2) Prisma

- From WSL terminal if Windows has errors:
    - prisma format → validate → migrate dev → db seed.
- Back in PowerShell, ensure node_modules/.prisma/client exists.

3) App run

- pnpm install
- pnpm build
- pnpm start
- Visit http://localhost:3000/en, /en/reports, /en/categories/technology.

4) cPanel deploy

- Zip repo (omit node_modules).
- Upload to nodeapps/tbi.
- Setup Node.js App → Create → Node 20.x → app root nodeapps/tbi → startup “npm start” or server.js.
- Add envs: DATABASE_URL, PRISMA_PROVIDER=mysql, NEXTAUTH_SECRET, LOCALES, DEFAULT_LOCALE.
- Run NPM Install.
- Open Terminal → cd nodeapps/tbi → pnpm build.
- Start app in cPanel.
- Map subdomain to the Node app URL.


## Leveraging FTP and MariaDB credentials

- FTP: upload builds and static assets; but prefer Git+SSH or cPanel Terminal to avoid partial uploads.
- MariaDB: use cPanel’s MySQL Databases to create credentials, store in environment variables only—not in code. Use phpMyAdmin to import/export dumps.


## High‑SEO + multilingual + AI content generation

- i18n: next-intl or next-i18next with locale subpaths.
- SEO: use Next App Router generateMetadata for per‑locale titles/descriptions; alternates.languages; canonical; JSON‑LD builders for Organization, WebSite, BreadcrumbList, Article.
- AI pipeline: Admin page to queue generation for selected report and locale; on approval, create/update report_translations row and revalidate ISR tags. Store token usage and model.


## Troubleshooting matrix (Windows specific)

- Prisma validation fails:
    - Ensure enums have no commas; LF line endings; UTF‑8; run prisma format.
    - Run prisma CLI in WSL to avoid encoding problems.
- Webpack build fails:
    - Align Node version; clear .next and node_modules; pnpm store prune; pnpm install; pnpm build.
- cPanel app shows 502:
    - Check app port; restart app; check logs in “Setup Node.js App” and ~/.npm/_logs; ensure startup file matches.


## Minimal SQL to bootstrap tables (if you want to create them before Prisma)

You can paste this into phpMyAdmin to create core structures matching the planned schema; Prisma can migrate over them later if needed:

- CREATE TABLE categories (id VARCHAR(191) PRIMARY KEY, slug VARCHAR(191) UNIQUE, parent_id VARCHAR(191) NULL, status ENUM('DRAFT','STAGED','PUBLISHED') DEFAULT 'DRAFT', created_at DATETIME DEFAULT CURRENT_TIMESTAMP, updated_at DATETIME DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP, INDEX idx_cat_slug_parent (slug, parent_id));
- CREATE TABLE category_translations (id VARCHAR(191) PRIMARY KEY, category_id VARCHAR(191) NOT NULL, locale ENUM('EN','DE','FR','ES','IT','JA','KO') NOT NULL, name VARCHAR(255) NOT NULL, description TEXT NULL, seo_title VARCHAR(255) NULL, seo_desc VARCHAR(320) NULL, UNIQUE uq_cat_loc (category_id, locale), INDEX idx_cat_loc_name (locale, name), FOREIGN KEY (category_id) REFERENCES categories(id) ON DELETE CASCADE);
- CREATE TABLE reports (... analogous with report_translations);
- CREATE TABLE leads (...);
- CREATE TABLE redirect_map (...);
- CREATE TABLE ai_generation_queue (...);
- CREATE TABLE ai_log (...);

Replace ... with fields discussed earlier; this ensures phpMyAdmin creation works even before Prisma.

## Immediate action checklist for you

1) Decide local DB: install MariaDB or MySQL Community.
2) Put a clean schema.prisma with provider=mysql (use LF and one‑value‑per‑line enums).
3) Run Prisma commands from WSL to avoid Windows parser issues.
4) pnpm build → pnpm start locally; verify pages and SEO tags.
5) On cPanel:
    - Create DB+user; set envs in Setup Node.js App.
    - Upload repo, install deps, run build, start.
    - Point a subdomain for demo.

If helpful, I can generate a tailored .env.production.example, a server.js (standalone), and a PM2 ecosystem file, or provide a one‑shot command script for WSL to bring up the DB + migrations + seed.

<div style="text-align: center">⁂</div>

[^1]: WhatsApp-Image-2025-08-07-at-20.06.02_5a08696c.jpg

[^2]: tbi_db_schema_analysis_report.txt

[^3]: https://arxiv.org/abs/2310.06770

[^4]: https://www.semanticscholar.org/paper/15abedb29536d50afeeec739a25358255cbda3e8

[^5]: https://www.taylorfrancis.com/books/9781003229100/chapters/10.1201/9781003229100-6

[^6]: https://arxiv.org/abs/2403.17927

[^7]: https://arxiv.org/abs/2407.17227

[^8]: https://dl.acm.org/doi/10.1145/3644032.3644443

[^9]: https://dl.acm.org/doi/10.1145/3633453

[^10]: https://dl.acm.org/doi/10.1145/3568813.3600138

[^11]: https://github.com/annasa28247/The-Brainy-Insights

[^12]: https://github.com/annasa28247

[^13]: https://github.com/Brainy-Technologies

[^14]: https://github.com/box/brainy

[^15]: https://github.blog/news-insights/product-news/universe-2023-copilot-transforms-github-into-the-ai-powered-developer-platform/

[^16]: https://dev.to/hasanulhaquebanna/host-nextjs-14-application-on-cpanel-2cig

[^17]: https://www.npmjs.com/package/@prisma%2Fadapter-mariadb

[^18]: https://github.com/gugarosa/brainy

[^19]: https://www.namecheap.com/support/knowledgebase/article.aspx/10686/29/how-to-deploy-reactjs-vitejs-react-native-and-nextjs-applications-in-cpanel/

[^20]: https://www.youtube.com/watch?v=bFLrUS_16Ao

[^21]: https://github.com/brainydigital

[^22]: https://prosperasoft.com/blog/full-stack/frontend/nextjs/how-to-deploy-nextjs-app-on-cpanel/

[^23]: https://www.youtube.com/watch?v=fvsqoLxOnX8

[^24]: https://github.com/IAmSuyogJadhav/Brainy

[^25]: https://nextjs.org/docs/app/getting-started/deploying

[^26]: https://github.com/prisma/prisma/issues/27598

[^27]: https://dl.acm.org/doi/10.1145/3545945.3569830

[^28]: https://arxiv.org/abs/2408.14354

[^29]: https://arxiv.org/abs/2207.08533

[^30]: https://arxiv.org/pdf/2301.10912.pdf

[^31]: https://www.eneuro.org/content/eneuro/early/2022/04/07/ENEURO.0482-21.2022.full.pdf

[^32]: https://arxiv.org/html/2410.02087v1

[^33]: https://arxiv.org/ftp/arxiv/papers/2309/2309.07671.pdf

[^34]: https://arxiv.org/html/2406.16791v2

[^35]: https://arxiv.org/abs/2204.09222

[^36]: https://pmc.ncbi.nlm.nih.gov/articles/PMC9464703/

[^37]: https://www.frontiersin.org/articles/10.3389/fninf.2019.00014/pdf

[^38]: https://pmc.ncbi.nlm.nih.gov/articles/PMC7880282/

[^39]: https://github.com/BrainyData

[^40]: https://www.youtube.com/watch?v=ruuVPm8jveM

[^41]: https://www.prisma.io

[^42]: https://github.com/insight-platform/Savant

